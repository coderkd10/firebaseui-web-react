{"version":3,"file":"FirebaseAuth.js","names":["_react","_interopRequireDefault","require","obj","__esModule","default","_inheritsLoose","subClass","superClass","prototype","Object","create","constructor","_setPrototypeOf","o","p","setPrototypeOf","bind","__proto__","ELEMENT_ID","firebaseUiDeletion","Promise","resolve","FirebaseAuth","exports","_React$Component","props","_this","call","uiConfig","firebaseAuth","className","uiCallback","unregisterAuthObserver","_proto","componentDidMount","_this2","firebaseui","then","firebaseUiWidget","auth","AuthUI","getInstance","signInFlow","reset","userSignedIn","onAuthStateChanged","user","start","componentWillUnmount","_this3","delete","render","createElement","id","React","Component"],"sources":["../src/FirebaseAuth.jsx"],"sourcesContent":["/**\n * Copyright 2017 Google Inc. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// @flow\n\nimport React from 'react';\n\n// Global ID for the element.\nconst ELEMENT_ID = 'firebaseui_container';\n\n// Promise that resolves unless the FirebaseUI instance is currently being deleted.\nlet firebaseUiDeletion = Promise.resolve();\n\n/**\n * React Component wrapper for the FirebaseUI Auth widget.\n */\nexport default class FirebaseAuth extends React.Component {\n  /**\n   * Constructor  Firebase Auth UI component\n   *\n   * @param {Object} props - Additional object properties.\n   * @constructor\n   */\n  constructor(props) {\n    super(props);\n\n    this.uiConfig = props.uiConfig;\n    this.firebaseAuth = props.firebaseAuth;\n    this.className = props.className;\n    this.uiCallback = props.uiCallback;\n    this.unregisterAuthObserver = () => {};\n  }\n\n  /**\n   * @inheritDoc\n   */\n  componentDidMount() {\n    // Import the css only on the client.\n    require('firebaseui/dist/firebaseui.css');\n\n    // Firebase UI only works on the Client. So we're loading the package in `componentDidMount`\n    // So that this works when doing server-side rendering.\n    const firebaseui = require('firebaseui');\n\n    // Wait in case the firebase UI instance is being deleted.\n    // This can happen if you unmount/remount the element quickly.\n    return firebaseUiDeletion.then(() => {\n      // Get or Create a firebaseUI instance.\n      this.firebaseUiWidget = firebaseui.auth.AuthUI.getInstance()\n           || new firebaseui.auth.AuthUI(this.firebaseAuth);\n      if (this.uiConfig.signInFlow === 'popup') {\n        this.firebaseUiWidget.reset();\n      }\n\n      // We track the auth state to reset firebaseUi if the user signs out.\n      this.userSignedIn = false;\n      this.unregisterAuthObserver = this.firebaseAuth.onAuthStateChanged((user) => {\n        if (!user && this.userSignedIn) {\n          this.firebaseUiWidget.reset();\n        }\n        this.userSignedIn = !!user;\n      });\n\n      // Trigger the callback if any was set.\n      if (this.uiCallback) {\n        this.uiCallback(this.firebaseUiWidget);\n      }\n\n      // Render the firebaseUi Widget.\n      this.firebaseUiWidget.start('#' + ELEMENT_ID, this.uiConfig);\n    });\n  }\n\n  /**\n   * @inheritDoc\n   */\n  componentWillUnmount() {\n    firebaseUiDeletion = firebaseUiDeletion.then(() => {\n      this.unregisterAuthObserver();\n      return this.firebaseUiWidget.delete();\n    });\n    return firebaseUiDeletion;\n  }\n\n  /**\n   * Properties types.\n   */\n  props: {\n    // The Firebase UI Web UI Config object.\n    // See: https://github.com/firebase/firebaseui-web#configuration\n    uiConfig: Object,\n    // The Firebase App auth instance to use.\n    firebaseAuth: Object,\n    // Callback that will be passed the FirebaseUi instance before it is\n    // started. This allows access to certain configuration options such as\n    // disableAutoSignIn().\n    uiCallback?: Function,\n    className?: String,\n  };\n\n  /**\n   * @inheritDoc\n   */\n  render() {\n    return (\n      <div className={this.className} id={ELEMENT_ID}/>\n    );\n  }\n}\n"],"mappings":"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"}